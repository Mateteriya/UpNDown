# Как откатить ПК-версию к «идеальной» из Git и сохранить мобильную

## Что у нас есть

- **Ветка `main`** — в ней сохранена «идеальная» ПК-версия (как было до мобильной разработки).
- **Ветка `mobile-ui`** — на ней делалась мобильная версия; в тех же файлах (CSS, GameTable и т.д.) есть и мобильные правки, и **случайные изменения**, которые затронули ПК.

Один и тот же код обслуживает и ПК, и мобильные: переключение по ширине экрана и `isMobile`. Поэтому нельзя «откатить один файл целиком с main» — в нём и мобильное, и ПК.

Нужно: **подтянуть в `mobile-ui` актуальную версию `main`** (чтобы ПК снова как на main) и **при конфликтах слить так, чтобы не потерять мобильные правки**.

---

## Пошаговый план

### Шаг 1. Сохранить текущую работу (ничего не потерять)

Все текущие изменения (и мобильные, и то, что задело ПК) нужно закоммитить на `mobile-ui`:

```bash
git add -A
git status
git commit -m "mobile: capacitor, overlap hint, meta, icons; WIP"
```

Так у тебя будет сохранён «почти идеальный мобильный» вариант. Его всегда можно вернуть по этому коммиту.

### Шаг 2. Подтянуть в mobile-ui «идеальную» ПК-версию с main

Сейчас нужно «влить» в твою ветку то, что лежит на `main` (идеальный ПК):

```bash
git merge main
```

Если Git напишет «Already up to date» — значит, в `main` нет новых коммитов относительно того, от чего ответвилась `mobile-ui`. Тогда «идеальный ПК» уже учтён в истории, а расхождения только в твоих коммитах и правках. Ниже — что делать, если появятся конфликты.

### Шаг 3. Если появятся конфликты (Conflict)

Git покажет, в каких файлах конфликт (например, `src/index.css`, `src/ui/GameTable.tsx`). Нужно в каждом таком файле **разрешить конфликт вручную**:

- Блоки между `<<<<<<<`, `=======`, `>>>>>>>` — это две версии одного и того же места.
- Правило при разрешении:
  - **Код, который относится к ПК (десктоп, общий вид без мобилки)** — оставляем как в версии **из `main`** (часто это верхний блок, до `=======`).
  - **Код, который относится только к мобильной версии** (внутри `@media (max-width: 600px)`, `.viewport-mobile`, ветки `isMobile`, мобильная разметка и т.п.) — оставляем **нашу текущую мобильную версию** (часто нижний блок, после `=======`).

После правки каждого файла:

```bash
git add путь/к/файлу
```

Когда все конфликты разрешены:

```bash
git commit -m "merge main: restore PC version, keep mobile changes"
```

(Текст коммита можно заменить на свой.)

### Шаг 4. Проверить ПК и мобильную

- Открыть приложение в браузере на **ПК** (широкий экран) — всё должно выглядеть как «идеальная» версия с main.
- Открыть на **телефоне** или в эмуляторе с узким экраном — мобильная версия должна остаться «почти идеальной».

### Шаг 5. Запушить только мобильную ветку

Пушим только ветку `mobile-ui` (main при этом не трогаем):

```bash
git push origin mobile-ui
```

В репозитории на GitHub/GitLab будет: `main` = идеальный ПК, `mobile-ui` = идеальный ПК + твоя мобильная версия (с откатом ПК к main через merge).

---

## Кратко

- **Сохранить мобильную** — закоммитить всё текущее на `mobile-ui` (шаг 1).
- **Восстановить ПК из Git** — сделать `git merge main` (шаг 2).
- **Не потерять мобильное при конфликтах** — при разрешении конфликтов оставлять из main только «ПК-часть», мобильные куски брать из текущей версии (шаг 3).
- **Не пушить лишнего** — пушим только `mobile-ui`, main не трогаем (шаг 5).

Если при merge или при разрешении конфликтов что-то непонятно — можно прислать список файлов с конфликтами и куски кода, и разберём точечно.
