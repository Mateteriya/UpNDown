# Что делать дальше — после сбоя чата «Позиционирование элементов карт для мобильной версии»

Текст того чата из базы Cursor достать нельзя — там хранятся только метаданные. Зато по коду и документам можно восстановить контекст и на чём вы остановились.

**Общий план всех шагов (фундамент → мобильная → онлайн → ИИ → архив → турниры):** [docs/PLAN-DALEE.md](./PLAN-DALEE.md).  
**Фундамент (имя, profileId, рейтинг, авторизация) выполнен** — см. [NEXT-STEPS-AUTH-RATINGS-ONLINE.md](./NEXT-STEPS-AUTH-RATINGS-ONLINE.md).

---

## Что мы точно знаем (из базы и кода)

- **Тема чата:** позиционирование элементов карт для мобильной версии.
- **В конце правили:** `vercel.json`, `AuthModal.tsx` (и ещё 26 файлов за всю сессию).
- **Уже есть в репо:**
  - **OAuth и возврат с авторизации:** `auth-callback.html`, редирект в `AuthContext` на `/auth-callback.html`, в `vercel.json` этот путь в исключениях — чтобы на мобильных не было чёрного экрана.
  - **Мобильная вёрстка:** стол, слоты взятки (сетка 2×2 на мобильных), панели Север/Запад/Восток/Юг, карты в руке и на столе — всё уже завязано на `viewport-mobile` и комментарии в коде про «мобильная», «позиционирование».
  - **План по аватаркам и именам:** готовый документ `docs/AVATARS-AND-NAMES-PLAN.md` — аватар (инициалы в кружке), имя в одной строке, для Востока на мобильной только круг + `title`.

То есть работа шла в сторону: мобильное позиционирование карт и панелей + авторизация/деплой.

---

## План «что делать дальше» (восстановленный по коду)

Используйте это как чеклист. Отмечайте по мере выполнения и дополняйте тем, что вспомните из того чата.

### 1. Позиционирование карт и стола на мобильной

- [ ] Проверить на реальном устройстве или в DevTools (375×667 и уже): рука игрока не вылезает за край, карты на столе в сетке 2×2, козырь на колоде на месте.
- [ ] Убедиться, что комментарии в `GameTable.tsx` и `CardView.tsx` (про «мобильная рука», «мобильный стол») соответствуют текущему виду; при расхождении — подправить стили в `index.css` (селекторы с `viewport-mobile` / `.game-table-root:not(.viewport-mobile)`).
- [ ] Если в том чате обсуждали конкретные пиксели/отступы — восстановить по памяти и записать сюда в раздел «Заметки по позициям» ниже.

**Breakpoints в коде:** класс `viewport-mobile` вешается при ширине **≤600px** (`useIsMobile`); слоты взятки в сетку 2×2 и компактный стол — при **≤1024px** (`useIsMobileOrTablet`). В CSS мобильные стили — в блоке `@media (max-width: 1024px)` с селектором `.game-table-root.viewport-mobile`.

### 2. Auth и Vercel

- [ ] Проверить вход через Google (и при необходимости другой OAuth) с мобильного: после редиректа открывается `auth-callback.html`, затем возврат в приложение без чёрного экрана.
- [ ] В Supabase: в Redirect URLs указаны продакшен-URL и `https://<ваш-домен>/auth-callback.html`.
- [ ] Если используете домен up2down.online / up2down.ru — проверить, что в проде всё открывается (известная история с блокировками в РФ; запасной вариант — vercel.app URL).

### 3. Аватарки и имена (уже расписано в отдельном плане)

- [x] Движок имени и аватар-инициалы реализованы (`PlayerAvatar`, профиль с displayName/avatarDataUrl/profileId).
- [x] На мобильной: Север/Запад — «[аватар] имя» в одну строку; Восток — только круг, имя в `title`.
- [ ] Опционально: загрузка фото аватара (план в `docs/AVATARS-AND-NAMES-PLAN.md`).

### 4. Сохранить то, что вспомните

- Ниже — блок **«Заметки по позициям»** и **«Планы из того чата»**. Как только вспомните формулировки планов или последний ответ ассистента — сразу сюда вставить (хотя бы тезисами). Так они останутся в репозитории и не потеряются.

---

## Как проверить шаг 2 (что сделать вам)

### Позиционирование (п.1)

1. **В браузере на ПК (Chrome/Edge):**
   - Откройте приложение (`npm run dev` или прод).
   - Откройте DevTools (F12) → включите режим эмуляции устройства (Ctrl+Shift+M).
   - Выберите размер **375×667** (iPhone SE) или свой телефон из списка.
   - Перезагрузите страницу, зайдите в «Офлайн против ИИ», начните игру.
   - Проверьте: рука внизу не обрезается по бокам и не вылезает за экран; четыре карты текущей взятки в центре стола в сетке 2×2; козырь на колоде виден и на месте.
   - При необходимости проверьте и портретную ориентацию (поменять ширину/высоту местами).

2. **На реальном телефоне (желательно):**
   - Откройте сайт в мобильном браузере (или через `npm run dev` с указанием `host: true` — зайти по IP компьютера в той же Wi‑Fi сети).
   - Повторите те же проверки: рука, сетка 2×2, козырь.

### Auth и OAuth с мобильного (п.2)

3. **Supabase:**
   - Зайдите в [Supabase](https://supabase.com) → ваш проект → **Authentication** → **URL Configuration**.
   - В **Redirect URLs** должны быть:
     - `https://<ваш-продакшен-домен>/auth-callback.html`
     - для теста с телефона по IP: `http://<IP-вашего-ПК>:5173/auth-callback.html` (если dev-сервер слушает на всех интерфейсах).
   - **Site URL** — основной URL приложения (например `https://your-app.vercel.app` или `http://localhost:5173` для разработки).

4. **Проверка входа с телефона:**
   - На телефоне откройте приложение (прод или по IP в локальной сети).
   - Нажмите «Вход» → «Войти через Google» (или GitHub).
   - После редиректа на Google и подтверждения должно открыться приложение (страница `auth-callback.html` с текстом «Завершение входа…», затем редирект на главную). Не должно быть чёрного экрана или зависания.
   - Если чёрный экран — проверьте, что в Redirect URLs в Supabase указан именно тот URL, с которого вы открыли приложение (с тем же протоколом и хостом).

5. **Домен в РФ:** если используете up2down.online / up2down.ru, проверьте доступность в проде; при блокировках запасной вариант — домен `*.vercel.app`.

---

## Заметки по позициям (дополняйте по памяти)

*Здесь можно кратко записать, что именно вы помните про позиционирование: например «карты на столе на мобильной — отступ сверху 8px», «рука не должна заходить под панель заказа» и т.д.*

- 

---

## Планы из того чата (дополняйте по памяти)

*Сюда — тезисы планов и последнего ответа, как только вспомните.*

- 

---

## Итого

Точный текст чата и «последний ответ» из базы достать нельзя, но по коду и документам видно: вы были на этапе доводки мобильного позиционирования карт/стола и настройки auth/vercel. **Дальше:** сначала пройти чеклисты 1–2 (позиционирование на 375×667, OAuth с мобильного), затем по [PLAN-DALEE.md](./PLAN-DALEE.md) — онлайн, уровни ИИ, архив результатов. По мере воспоминаний дополняйте «Заметки по позициям» и «Планы из того чата».
