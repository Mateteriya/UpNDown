# Резервная копия данных приложения (перед очисткой сайта)

В режиме инкогнито Chrome не показывает «Установить приложение». Чтобы переустановить PWA с правильной иконкой и не потерять данные — сначала попробуйте вариант А; если не поможет — вариант Б с бэкапом.

---

## Вариант А: Сбросить только кэш (данные не трогать)

1. Откройте **http://localhost:5173**.
2. **F12** → вкладка **Network** → поставьте галочку **Disable cache**.
3. **F12** → вкладка **Application** → слева **Service Workers** → нажмите **Unregister** у воркера этого сайта (если есть).
4. Слева **Cache Storage** → раскройте `http://localhost:5173` → правый клик по каждому кэшу → **Delete**.
5. Обновите страницу с принудительным обновлением: **Ctrl+Shift+R**.
6. Снова нажмите «Установить приложение».

Если иконка по-прежнему старая — переходите к варианту Б (бэкап → полная очистка → установка → восстановление).

---

## Вариант Б: Полная очистка с бэкапом и восстановлением

### 1. Сохранить данные (бэкап)

1. Откройте приложение на **http://localhost:5173** (обычное окно, не инкогнито).
2. Нажмите **F12** → вкладка **Console** (Консоль).
3. Вставьте этот код и нажмите **Enter**:

```javascript
copy(JSON.stringify(Object.fromEntries(
  Object.entries(localStorage).filter(([k]) => k.startsWith('updown_'))
)));
console.log('Скопировано в буфер обмена. Вставьте в текстовый файл и сохраните как backup.txt');
```

4. Данные скопируются в буфер. Вставьте их (Ctrl+V) в блокнот и сохраните файл **backup.txt** на рабочий стол.

---

### 2. Очистить данные сайта и переустановить приложение

1. **F12** → вкладка **Application** (Приложение).
2. Слева **Storage** → **Clear site data** (Очистить данные сайта).
3. Закройте вкладку, снова откройте **http://localhost:5173** и установите приложение — иконка должна подтянуться.
4. После установки переходите к восстановлению (шаг 3).

---

### 3. Восстановить данные

1. Откройте приложение (можно с ярлыка) на **http://localhost:5173**.
2. **F12** → вкладка **Console**.
3. Откройте ваш **backup.txt**, скопируйте всё его содержимое (один JSON-объект).
4. В консоли выполните (замените `ВАШ_БЭКАП` на вставленный текст):

```javascript
const backup = ВАШ_БЭКАП;  // вставьте сюда содержимое backup.txt
if (typeof backup === 'object' && backup !== null) {
  Object.entries(backup).forEach(([k, v]) => localStorage.setItem(k, v));
  console.log('Данные восстановлены.');
} else {
  console.log('Неверный формат. Вставьте содержимое backup.txt в переменную backup.');
}
```

**Удобнее так:** в backup.txt у вас одна строка вида `{"updown_game_state":"...", ...}`. В консоли напишите:

```javascript
const backup = {"updown_game_state":"...", "updown_player_profile":"..."};  // вставьте свою строку из backup.txt
Object.entries(backup).forEach(([k, v]) => localStorage.setItem(k, v));
console.log('Готово.');
```

5. Обновите страницу (F5) — сохранённая партия, профиль и рейтинг должны вернуться.
