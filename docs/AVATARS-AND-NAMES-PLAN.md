# Аватарки и имена игроков — план внедрения

## Цель
Добавить отображение аватарок и имён без расширения панелей на мобильной. Сначала — движок имени пользователя и аватар по умолчанию (инициалы в кружке), затем опционально — загрузка фото.

---

## Текущая раскладка (мобильная)

| Зона | Ширина / место | Сейчас в шапке |
|------|----------------|----------------|
| **Север, Запад** (top row) | ~120–160px | Только имя |
| **Восток** (рядом со столом) | **28–44px** | Имя вертикально |
| **Юг** (игрок) | Вся ширина, max-height ~38vh | Имя + бейджи «Сдающий» / «Первый заказ» |

Высота: панели уже компактные, лишнюю строку добавлять не хотим.

---

## Идея: одна строка «[аватар] имя» без увеличения высоты

- **Аватар** — круг фиксированного размера слева от имени.
- **Имя** — в той же строке, при нехватке места обрезается с `...` (как сейчас по сути уже есть через line-clamp/overflow).
- Высота строки не меняется: круг по высоте совпадает с размером шрифта или чуть больше (например 24–28px), выравнивание по центру.

Так мы **не расширяем панели** и не делаем «или ава, или ник» — и то и другое в одной линии.

---

## Размеры аватара по зонам

| Зона | Размер круга | Комментарий |
|------|--------------|-------------|
| Север, Запад (мобильная) | 24–26px | Влезает в текущий header, имя справа с ellipsis |
| Восток (мобильная) | 24px | Ширина 28–44px — **только круг**, имя в `title` (при наведении/долгом тапе) |
| Юг (игрок, мобильная) | 26px | Рядом с именем, как у оппонентов |
| ПК (все слоты) | 32–36px | Места больше, можно чуть крупнее |

Для **Востока** на мобильной: показывать только аватар (круг с инициалами), полное имя — по `title` или по долгому нажатию, чтобы не ломать узкую колонку.

---

## Аватар по умолчанию (MVP): инициалы в кружке

- **Без загрузки фото в первом релизе:** круг с двумя буквами (инициалы от имени) и цветом фона от индекса игрока или от хеша имени.
- Плюсы: не нужны хранилище и UI загрузки, все сразу с аватаркой, узнаваемость по цвету и буквам.
- Позже: опциональное поле «фото» (URL или файл), если есть — показываем его в круге, иначе — инициалы.

---

## Где хранить имя и аватар

- **Имя:** в существующей модели игрока (`state.players[humanIdx].name`). При первом запуске — запрос имени (модалка/экран), сохранение в `localStorage` + в persistence (как сейчас сохраняем состояние игры).
- **Аватар (позже):** `avatarUrl?: string | null` в профиле пользователя; в GameState для человеческого игрока можно передавать из контекста/профиля, не обязательно дублировать в каждом состоянии игры.

Сначала делаем только **имя + инициалы в круге** (без поля avatarUrl).

---

## Этапы

1. **Движок имени**  
   - Экран/модалка при первом запуске: «Введите имя» (или «Как к вам обращаться?»).  
   - Сохранение в localStorage + подстановка в `createGame(..., humanPlayerName)`.  
   - Опционально: пункт «Изменить имя» в меню или в настройках.

2. **Аватар-заглушка (инициалы)**  
   - Компонент `PlayerAvatar`: круг, внутри 1–2 буквы (инициалы), цвет по индексу/хешу имени.  
   - Вставить в шапку оппонента: `[PlayerAvatar] имя` (Север, Запад, Юг).  
   - Для Востока на мобильной: только `PlayerAvatar`, имя в `title`.  
   - Стили: без увеличения высоты панели, при необходимости чуть уменьшить отступы (gap), чтобы имя не обрезалось слишком рано.

3. **ПК**  
   - Те же компоненты в слотах ПК, размер круга 32–36px.

4. **Позже**  
   - Опциональная загрузка фото аватара.  
   - При наличии `avatarUrl` — показывать изображение в круге, иначе — инициалы.

---

## Риски и смягчение

- **«Восток» очень узкий:** показываем только аватар, имя по tooltip — пользователь всё равно видит «кто там», по инициалам и цвету можно запомнить.  
- **Длинные имена:** уже есть ограничение (например 17 символов) и перенос/ellipsis; аватар забирает 24–28px + gap, имя получает `min-width: 0` и `text-overflow: ellipsis`.  
- **Расширение панелей:** не делаем — всё укладываем в одну строку и при необходимости чуть уменьшаем padding/gap.

После утверждения плана можно переходить к п.1 (движок имени) и п.2 (компонент аватара с инициалами и вставка в панели).
